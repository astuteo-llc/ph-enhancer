!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("posthog-js")):"function"==typeof define&&define.amd?define(["exports","posthog-js"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).PhEnhancer={},e.posthog)}(this,(function(e,r){"use strict";const t={THEME_PREFERENCE:"theme_preference",SEARCH:"search",ORGANIZATION:"organization"};let n=null,o=null;const a=(e,t={})=>{try{return!("undefined"==typeof window||!r?.capture)&&(r.capture(e,t),!0)}catch(e){return console.error("Tracking error:",e),!1}},i=()=>{try{const e=window.matchMedia("(prefers-color-scheme: dark)").matches,o=e?"dark":"light";if(o===n)return;n=o,a(t.THEME_PREFERENCE,{theme:o,prefers_dark_mode:e}),r.people.set({prefers_dark_mode:e})}catch(e){console.error("Error tracking theme preference:",e)}},c=()=>{try{const e=window.matchMedia("(prefers-color-scheme: dark)");o=i,e.addEventListener?e.addEventListener("change",o):e.addListener(o)}catch(e){console.error("Error adding theme listener:",e)}},s=()=>{try{const e=window.matchMedia("(prefers-color-scheme: dark)");o&&(e.removeEventListener?e.removeEventListener("change",o):e.removeListener(o))}catch(e){console.error("Error removing theme listener:",e)}},d=(e={})=>{a(t.SEARCH,{search_query:e.query||"",search_results_count:e.resultsCount||0,search_category:e.category||"",...e})},h=async(e=!1)=>{if(!e)return!1;try{if("undefined"==typeof window||!r?.capture)return!1;const n=await fetch(`/astuteo-toolkit/info?authKey=${encodeURIComponent(e)}`);if(!n.ok)return console.error("Failed to fetch organization data:",n.statusText),!1;const o=await n.json();return o&&o.organization?(a(t.ORGANIZATION,{organization:o.organization}),r.people.set({organization:o.organization}),!0):(console.error("Organization data not found in response"),!1)}catch(e){return console.error("Error tracking organization:",e),!1}},u=(e={})=>{if("undefined"==typeof window||!r)return!1;try{return r.people.set_once({initial_referrer:document.referrer}),i(),c(),h(e.authKey).catch((e=>{console.error("Failed to track organization during initialization:",e)})),!0}catch(e){return console.error("Error initializing tracking:",e),!1}},l=()=>{s(),n=null};var f={init:u,cleanup:l,trackThemePreference:i,trackSearch:d,trackOrganization:h,events:t};e.EVENTS=t,e.addThemeChangeListener=c,e.cleanup=l,e.default=f,e.initTracking=u,e.removeThemeChangeListener=s,e.trackEvent=a,e.trackOrganization=h,e.trackSearch=d,e.trackThemePreference=i,Object.defineProperty(e,"__esModule",{value:!0})}));
